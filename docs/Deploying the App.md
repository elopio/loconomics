# Deploying the App
Our app targets the web platform and the native iOS and Android platforms. That means, from our common source code we are able to generate a webapp (served from loconomics.com), a native iOS app and a native Android app.

We use [Phonegap](http://phonegap.com/) to build the iOS and Android apps to later be uploaded to their respective stores.

## Phonegap Build Service
We use the [Phonegap Build](https://build.phonegap.com/) service to build the app for iOS and Android in the cloud.

This is our preferred way, both to generate the production version of the app ('live' channel) and testing versions when some debugging in actual devices is needed (working against 'dev' or 'testing' channels).

## Phonegap cli
The Phonegap cli can be used to build the app locally on a developer machine. It's more complex, has lot of requirements and may throw platform-specific errors.

Start by installing the tools from npm (may require elevated privileges, like 'su root' on \*nix machines):
```
npm install -g phonegap
```

You will need the **SDKs** of each platform you want to build for.

The project has a folder ready to store results of a local build, but that files are ignored by git: the /app/phonegap folder.

There are some config files that are generated by a Grunt task based on templates. Just runt the task 'grunt prepare-phonegap'.

**Note** that the Phonegap plugins used by the project must be installed before building; they are listed at the generated config.xml file and are fetched from npm or git repositories. At recent versions of the Phonegap cli you can run next command (from command line at the /app/phonegap folder) to automatically get them installled:
```
phonegap plugin install
```

On previous versions, or to test some plugin without add it still to the project source, you can install each plugin individually with next command (is an example where the URL must be replaced by the plugin git repository):
```
phonegap plugin add https://git-wip-us.apache.org/repos/asf/cordova-plugin-inappbrowser.git
```

**Important:**: do **not** modify the /app/phonegap/www/config.xml file manually, as already commented is autogenerated (for example, if you need to add a plugin, do not add it there and do not add it using 'phonegap plugin add xx --save'). You must add a plugin line at the file /app/source/cordova-config.js.xml (look at the *plugin* elements), set a specific version and run the 'grunt prepare-phonegap' task. Remember that the PhoneGap Build service use this list of plugins to automatically install them too (and the whole file, for any setup), so any addition must be compatible (check docs or ask teammates for advice).

### iOS 
[Download and install Apple XCode](https://itunes.apple.com/us/app/xcode/id497799835?mt=12) and run the command:
```
phonegap build ios
```  

### Android
[Download and install Android Studio](https://developer.android.com/studio/index.html) and run the command:
```
phonegap build android
```

### Web
In terminal enter command:
```
grunt build-webapp
```
that will build the html, and build/copy assets (js, css, images, fonts).

If assets are already generated, you can build only the html:
```
grunt build-webapp-html 
```

The output files for that tasks goes to the /web directory; in a local environment with the [back-end setup done](Backend Development Environment Setup Guide.md), you can just try it at your localhost dev server.
To update a remote webserver, upload the following files via FTP from your local machine:
- web/_specialRoutes/app.html (single file)
- web/assets (all folder contents)
