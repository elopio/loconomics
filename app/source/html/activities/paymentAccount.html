<div data-activity="paymentAccount" class="Boxes-sm animated">
    <app-inline-user-menu>@render('parts/UserMenuContents.html')</app-inline-user-menu>
    <div class="container">
        <div class="row">  
            <div class="SubSectionNavBar hidden-xs hidden-sm">
                <ul>
                    <li>
                        <a href="/marketplaceProfile"><i class="fa fa-fw ion-ios-arrow-thin-left"></i> Marketplace profile</a>
                    </li>
                </ul>
            </div>
            <div class="LightForm col-md-7 col-sm-reset">
                <h2 class="SectionTitle">
                    <span>Payout preference</span>
                    <span class="pull-right hidden-xs hidden-sm"><a class="hidden-xs hidden-sm" href="https://loconomics.com/#!/help/relatedArticles/201967096-accepting-and-receiving-payments" target="_blank">Help <i class="fa fa-fw ion-ios-help-outline"></i></a>
                    </span>
                </h2>
                <div class="container-fluid">
                    Getting paid is the easy part. We've partnered with Braintree (a leading credit card merchant provider) to deposit any marketplace payments directly to your bank account. Braintree's transaction fee (2.9% plus $0.30 transaction fee) is subtracted from your payment. Easy, right? Complete the information below.
                </div>
                <div class="container-fluid" data-bind="visible: paymentAccount.status()">
                    <h2 class="SectionTitle">Merchant account status</h2>
                    <p data-bind="visible: paymentAccount.status() === 'active'" class="bg-success PaddedBox-xs">
                        You're all set up with Braintree. We'll deposit any payments due to you
                        <span data-bind="visible: paymentAccount.accountNumber">to your account ending in <span data-bind="text: paymentAccount.accountNumber"></span></span>
                        <span data-bind="visible: !paymentAccount.accountNumber()">to your Venmo account attached to e-mail address <span data-bind="text: paymentAccount.email"></span>.</span>
                    </p>
                    <p data-bind="visible: paymentAccount.status() === 'pending'" class="bg-warning PaddedBox-xs">
                        We're working with Braintree to set up your merchant account. Please check back in 24 hours for an update.
                    </p>
                    <div data-bind="visible: paymentAccount.status() === 'suspended'" class="bg-danger PaddedBox-xs">
                        <p>We're having problems setting up your Braintree account. Please <a href="/contactForm/payments?mustReturn=true">contact us</a> for further assistance.</p>
                        <div data-bind="visible: paymentAccount.errors().length">
                            <p>Error(s) reported by Braintree:</p>
                            <ul data-bind="foreach: paymentAccount.errors()">
                                <li data-bind="text: this"></li>
                            </ul>
                        </div>
                    </div>
                    <div class="isolated text-center" data-bind="visible: !formVisible()">
                        <button type="button" class="btn btn-info" data-bind="click: showForm">Update Bank Info</button>
                    </div>
                </div>
                <div class="LightForm container-fluid" data-bind="with: paymentAccount, visible: formVisible">
                    <h2 class="SectionTitle">Your contact information</h2>
                    <app-unlabeled-input params="placeholder: 'First name', value: firstName, disable: $root.isLocked"></app-unlabeled-input>
                    <app-unlabeled-input params="placeholder: 'Last name', value: lastName, disable: $root.isLocked"></app-unlabeled-input>
                    <app-unlabeled-input params="placeholder: 'Phone', value: phone, disable: $root.isLocked"></app-unlabeled-input>
                    <app-unlabeled-input params="placeholder: 'Street address', value: streetAddress, disable: $root.isLocked"></app-unlabeled-input>
                    <div class="form-group" data-bind="css: { 'has-error': $root.errorMessages.postalCode() }">
                      <input type="number" class="form-control"
                             placeholder="Postal code" aria-label="Postal code"
                             data-bind="value: postalCode, disable: $root.isLocked,
                                        popover: { content: $root.errorMessages.postalCode(), trigger: 'focus', container: 'body', placement: 'bottom' }">
                    </div>
                    <div class="form-group">
                        <p class="form-control-static">
                            <span data-bind="visible: city() || stateProvinceCode()">
                                <span data-bind="text: city"></span>, 
                                <span data-bind="text: stateProvinceCode"></span>
                            </span>
                            <!-- White space to reserve space -->
                            &nbsp;
                        </p>
                    </div>
                    <app-unlabeled-input params="placeholder: 'Date of birth', value: birthDate, disable: $root.isLocked"></app-unlabeled-input>
<!--                    <app-unlabeled-input params="placeholder: 'SSN', value: ssn, disable: $root.isLocked"></app-unlabeled-input>-->

                    <h2 class="SectionTitle">Choose how you want your earnings deposited</h2>
                    <p class="text-center">
                        <button type="button" class="btn" data-bind="css: { 'btn-secondary': $parent.isBankAccount, 'btn-default': $parent.isVenmoAccount }, click: $parent.chooseBankAccount">Bank account</button>
                        <button type="button" class="btn" data-bind="css: { 'btn-secondary': $parent.isVenmoAccount, 'btn-default': $parent.isBankAccount }, click: $parent.chooseVenmoAccount">Venmo account</button>
                    </p>
                    <p data-bind="visible: $parent.isVenmoAccount">
                        If you choose not to enter your bank information,
                        a <a href="https://venmo.com" target="_system">Venmo</a> account will be created and linked to your email.
                        You will then have to set up your Venmo account to release payments. We do not recommend this option as it requires you to cash out every time you get a payment.
                    </p>
                    <div class="form-group" data-bind="visible: $parent.isBankAccount">
                        <label for="paymentAccount-routingNumber" class="control-label" data-bind="css: { 'sr-only': !status() }">ABA Routing Number</label>
                        <input type="text" class="form-control" data-bind="textInput: routingNumber, disable: $root.isLocked" placeholder="ABA Routing number">
                    </div>
                    <div class="form-group" data-bind="visible: $parent.isBankAccount">
                        <label for="paymentAccount-routingNumber" class="control-label" data-bind="css: { 'sr-only': !status() }">Account number</label>
                        <input type="text" class="form-control" data-bind="textInput: accountNumber, disable: $root.isLocked" placeholder="Account number">
                    </div>

                    <h2 class="SectionTitle">Agree to the terms of service</h2>
                    <p>
                        Loconomics Cooperative, Inc. (Loconomics) uses Braintree Payment Solutions LLC (Braintree) for payment processing. In order for you to use Braintree's payment processing services, you must enter into the Merchant Services Agreement (MSA) with Braintree and its sponsoring bank. The MSA is available at <a class="text-secondary" href="www.braintreepayments.com/agreements/merchant" target="_blank">www.braintreepayments.com/agreements/merchant</a>. By accepting this Agreement, you agree: (a) that you have downloaded or printed the MSA, and (b) that you have reviewed and agree to the MSA. Please note that Loconomics is not a party to the MSA and that you, Braintree and Braintree's sponsoring bank are the three parties to the MSA and that Loconomics has no obligations or liability to you under the MSA. If you have questions regarding the MSA, please contact Braintree at 877.434.2894.
                    </p>
                    <label class="form-label"><input type="checkbox" data-bind="checked: agree, disable: $root.isLocked" /> <span>I agree to the above terms of service</span></label>

                    <div class="LightForm-submitBar">
                        <div>
                            <button type="submit" value="Save" class="btn btn-primary btn-block" data-bind="text: $root.submitText, disable: $root.isLocked, click: $root.save">Save</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="SideMenu hidden-xs hidden-sm col-md-3 col-md-offset-1">
                <app-inline-side-menu params="vocElement: 'marketplaceProfile'"></app-inline-side-menu>
            </div>
        </div>
    </div>
</div>    
